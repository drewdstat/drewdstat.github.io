{
  "hash": "f86982d301255b2bcca74c4ddec64d8d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"DrewDayRFunctions: An Overview\"\nauthor: \"Drew Day\"\ndate: \"12/20/2024\"\nexecute:\n  freeze: auto\ncategories:\n  - DrewDayRFunctions\n---\n\n\n### Introduction\n\nDrewDayRFunctions is an R package I created to share convenience functions that aid in epidemiologic and other statistical analyses, focusing on regressions, exploratory data analysis, visualizations, and mediation. \n\nThis document provides a brief overview of the main functions within this package. Click on each tab for a brief description of what each main function does:\n\n\n\n```{css}\n.nav-pills .panel-tabset {\n    display: flex;\n}\n\n.nav.nav-tabs {\n    display: flex !important;\n    flex-direction: column;\n    flex: 0 0 auto;\n}\n\n.nav-pills .panel-tabset .nav-tabs .nav-item {\n    width: max-content;\n    height: 50px;\n    display: contents;\n}\n```\n\n\n::: {.panel-tabset .nav-pills}\n\n### GLMResults\n\nThis is a useful function for quickly [running a whole bunch of linear regressions]{.underline .bold} and getting useful plots and diagnostics out of them. \n\nThis runs many regressions by taking combinations of predictors, outcome, and covariates; performing linear regressions or generalized linear regressions for binary or count outcomes (logistic, log binomial, probit, Poisson, negative binomial, etc.); and returning 1. a table of coefficient and diagnostic values, 2. a summary plot, and 3. a list of all model objects for any follow-up analyses. Options include adding categorical or continuous interaction terms, using robust errors, performing multiple imputation using MICE, k-fold cross validation, and rerunning models when excluding high-leverage points. \n\nHere is an example plot output for models concerning car engines with continuous outcomes MPG and Horsepower, continuous predictors Weight, Displacement, 1/4 Mile Time, and Rear Axle Ratio; and a categorical interaction term VS (V-shaped engine or straight engine):\n\n![](img/glmresults_example.png){width=70%}\n\n### Contrast Coefficients\n\nThis function extracts all the coefficients from regression models that have categorical variables with >2 levels.\n\nThis extracts all the binary combinations of contrasts for a categorical (factor) predictor of interest and/or interaction term from a linear model. For example, if a predictor variable of interest is a 4-level categorical treatment variable with factor levels {\"placebo\", \"drug1\", \"drug2\", \"drug3\"}, a typical linear model will only return the \"drug1 - placebo\", \"drug2 - placebo\", and \"drug3 - placebo\" binary contrast coefficients. This function will return all binary contrast coefficients for all possible referent levels, meaning the aforementioned coefficients will be returned, as well the coefficients for \"drug2 - drug1\", \"drug 3 - drug 1\", and \"drug 3 - drug 2\". Furthermore, ContrastCoefficients can also provide all contrasts for a categorical interaction term as well, including all marginal coefficients for the main effects (e.g., predictor given interacting variable = level 1, predictor given interacting variable level 2, etc.). This works for all sorts of linear models and GLMs, including with MICE imputation.\n\nBelow is example output for a model regressing MPG for an engine on continuous weight (\"wt\") and categorical number of engine cylinders (\"cyl\"; 4, 6, or 8):\n\n![](img/contrastcoefficients_example.png){width=85%}\n\n### GAMResults\n\nThis is a useful function for [running lots of GAMs]{.underline .bold} and getting back useful visualizations and diagnostics.\n\nThis function takes combinations of predictor of interest, outcome, and covariate variables, performs linear or binary generalized additive models, and returns 1. a table of parameter and diagnostic values, 2. summary plot(s), and 3. a list of all model objects. Options include adding continuous and categorical variable by smooth interactions, performing smooth selection, and rerunning models when excluding upper/lower quantiles of data to examine edge effects on smooth fits. \n\nHere is some example output for a toy example with a continuous predictor (\"X\") smooth interaction with the categorical variable sex (\"S\"). The red curve is for females, the blue curve is for males, and the green curve is the difference between those curves, each with effective degrees of freedom (EDF) and smooth p-values displayed:\n\n![](img/gamresults_example.png){width=60%}\n\n### InteractionCoefPlot\n\nThis [visualizes continuous by continuous interactions]{.underline .bold} and was used for a [2024 Melamine paper in Environmental Research](https://www.sciencedirect.com/science/article/abs/pii/S0013935124006935): \n\nThis is a function for visualizing continuous by continuous interactions from linear regression models. These plots show how the coefficient between one variable in a bivariate continuous interaction and the outcome changes over levels of the interacting variable. \n\nThe example below is from a toy dataset and a model regressing some outcome on the main effects and interaction of predictors \"X1\" and \"X2\":\n\n![](img/interactioncoefplot_example.png){width=60%}\n\n### GenericDataSummary\n\nThis [generates an interactive HTML Markdown document]{.underline .bold} to summarize all the variables in a dataset.\n\nThis function takes a data frame and outputs an HTML Markdown document that contains an interactive table with a data dictionary if one is provided, an interactive table of summary statistics for the continuous variables as well as boxplots and histograms for those variables, and a searchable table showing frequencies for all categorical variables that also uses a bar plot to visualize frequencies. This is an easy way to summarize a newly obtained dataset or to send a general summary to someone who will be receiving a dataset. \n\nBelow is a screenshot from an example document using the built-in \"iris\" dataset:\n\n![](img/genericdatasummary_example.png){width=100%}\n\n### MediationCurve\n\nThis function evaluates and visualizes [nonlinear mediation]{.underline .bold}.\n\nThis function extends the functionality of the 'mediate' function from the 'mediation' R package for causal mediation analysis as defined by [Imai et al. 2010](https://imai.fas.harvard.edu/research/files/BaronKenny.pdf) for modelling linear and nonlinear mediation effects in the case of a continuous treatment. Mediation analysis is applied over a range of continuous treatment values to obtain a curve of the average causal mediation effect (ACME), average direct effect (ADE), total effect, and the proportion mediated. This is useful for characterizing nonlinear mediation effects. \n\nHere is example output from the associated plot.medcurve function. There is a parabolic curvilinear association between the exposure and mediator, and between the mediator and outcome. The red point is the comparison “control” treatment level, fixed at about the median. Each point and set of CIs reflect the ACME estimate when comparing a treatment at that level to the “control” treatment where the red point is (zero). Each point estimate is connected with a smooth fit to estimate the ACME function:\n\n![](img/plotmedcurve_example.png){width=70%}\n\n### GetExcelColors\n\nThis function extracts and summarizes [Excel spreadsheet background colors]{.underline .bold}.\n\nThis function takes an Excel spreadsheet from a .xlsx file and creates a data frame where the values in the dataset are replaced with all the background colors in that Excel sheet. It also provides a table and heatmap plot showing how many cells have each color detected in the Excel spreadsheet. This function is useful for when important information is encoded in the background colors of an Excel file. \n\nHere is an example plot that summarizes all colors in a given spreadsheet and total cell counts with each color: \n\n![](img/getexcelcolors_example.png){width=50%}\n:::\n\n",
    "supporting": [
      "DrewDayRFunctions_overview_files"
    ],
    "filters": [],
    "includes": {}
  }
}